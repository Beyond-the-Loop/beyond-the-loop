<script lang="ts">
	export let rating: number = 0;
	export let max: number = 5;

	$: fullStars = Math.floor(rating);
	$: hasPartial = rating % 1 !== 0;
	$: partialFill = (rating % 1) * 100;
</script>

<div class="flex flex-col items-center gap-1.5">
	<div class="flex gap-0.5">
		{#each Array(fullStars) as _, i}
			<svg
				class="size-3 filled text-lightGray-100 dark:text-white"
				viewBox="0 0 7 10"
				fill="none"
				xmlns="http://www.w3.org/2000/svg"
			>
				<path
					d="M2.77959 0V1.28281C2.52994 1.31456 2.2839 1.37055 2.04489 1.45C1.65279 1.58184 1.30327 1.81831 1.03331 2.13437L1.0163 2.15469C0.769755 2.45972 0.628548 2.83773 0.614144 3.23125C0.587936 3.66321 0.718852 4.08996 0.982271 4.43125L1.00238 4.45781C1.24654 4.74976 1.56074 4.97355 1.91496 5.10781C2.26744 5.23974 2.62941 5.34421 2.99768 5.42031C3.26991 5.47969 3.44469 5.52031 3.60092 5.56406H3.61793C3.8221 5.61406 3.9907 5.65938 4.14073 5.70312C4.319 5.75661 4.48879 5.83553 4.64497 5.9375C4.73343 5.99414 4.80885 6.06926 4.86616 6.15781C4.92198 6.26618 4.94915 6.38728 4.94504 6.50938C4.94504 6.51875 4.94504 6.52813 4.94504 6.5375C4.94975 6.68765 4.90576 6.83525 4.81975 6.95781C4.68969 7.13102 4.51224 7.26193 4.30933 7.33438C3.99665 7.45508 3.66323 7.51139 3.32869 7.5H3.29002C2.92728 7.51159 2.56694 7.43664 2.23823 7.28125C2.07741 7.19611 1.93901 7.07344 1.83453 6.92344L1.47568 6.41406L0.46875 7.14062L0.826049 7.65625C1.04805 7.97102 1.34132 8.22763 1.6814 8.40469L1.69842 8.4125C2.04079 8.57358 2.4062 8.67904 2.78114 8.725V10H4.01854V8.7C4.26861 8.66069 4.51386 8.5947 4.75015 8.50313C5.17357 8.34525 5.54302 8.06751 5.81431 7.70313C6.03042 7.38853 6.1567 7.01995 6.17935 6.63772C6.20199 6.25548 6.12012 5.87432 5.94269 5.53594L5.93341 5.52031C5.77836 5.26096 5.56676 5.04079 5.31471 4.87656C5.06317 4.71734 4.79091 4.59429 4.50576 4.51094C4.34181 4.4625 4.1562 4.4125 3.93501 4.35469C3.75868 4.30625 3.56689 4.26094 3.27146 4.19844C2.96201 4.13422 2.65794 4.04594 2.36197 3.93438C2.21183 3.87763 2.07792 3.78423 1.97219 3.6625C1.88949 3.56305 1.84647 3.43603 1.85154 3.30625C1.85154 3.28594 1.85154 3.26562 1.85154 3.24531C1.86148 3.13668 1.90291 3.03341 1.97064 2.94844C2.09472 2.80405 2.25501 2.6961 2.43467 2.63594C2.72863 2.53698 3.03752 2.49096 3.34725 2.5H3.36736C3.60187 2.4996 3.8354 2.5306 4.06185 2.59219C4.21659 2.6355 4.36264 2.70583 4.49339 2.8C4.57522 2.85751 4.64555 2.93014 4.70065 3.01406L5.04249 3.53594L6.07417 2.84531L5.73234 2.32344C5.59215 2.10925 5.4132 1.92371 5.2049 1.77656C4.95857 1.60032 4.6838 1.46868 4.39285 1.3875C4.26913 1.3531 4.14366 1.32545 4.01699 1.30469V0H2.77959Z"
					fill="currentColor"
				/>
			</svg>
		{/each}

		{#if hasPartial}
			<div
				class="size-3 partial-wrapper text-lightGray-900 dark:text-white/50"
				style="--fill: {partialFill}%"
			>
				<svg class="size-3" viewBox="0 0 7 10" fill="none" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M2.77959 0V1.28281C2.52994 1.31456 2.2839 1.37055 2.04489 1.45C1.65279 1.58184 1.30327 1.81831 1.03331 2.13437L1.0163 2.15469C0.769755 2.45972 0.628548 2.83773 0.614144 3.23125C0.587936 3.66321 0.718852 4.08996 0.982271 4.43125L1.00238 4.45781C1.24654 4.74976 1.56074 4.97355 1.91496 5.10781C2.26744 5.23974 2.62941 5.34421 2.99768 5.42031C3.26991 5.47969 3.44469 5.52031 3.60092 5.56406H3.61793C3.8221 5.61406 3.9907 5.65938 4.14073 5.70312C4.319 5.75661 4.48879 5.83553 4.64497 5.9375C4.73343 5.99414 4.80885 6.06926 4.86616 6.15781C4.92198 6.26618 4.94915 6.38728 4.94504 6.50938C4.94504 6.51875 4.94504 6.52813 4.94504 6.5375C4.94975 6.68765 4.90576 6.83525 4.81975 6.95781C4.68969 7.13102 4.51224 7.26193 4.30933 7.33438C3.99665 7.45508 3.66323 7.51139 3.32869 7.5H3.29002C2.92728 7.51159 2.56694 7.43664 2.23823 7.28125C2.07741 7.19611 1.93901 7.07344 1.83453 6.92344L1.47568 6.41406L0.46875 7.14062L0.826049 7.65625C1.04805 7.97102 1.34132 8.22763 1.6814 8.40469L1.69842 8.4125C2.04079 8.57358 2.4062 8.67904 2.78114 8.725V10H4.01854V8.7C4.26861 8.66069 4.51386 8.5947 4.75015 8.50313C5.17357 8.34525 5.54302 8.06751 5.81431 7.70313C6.03042 7.38853 6.1567 7.01995 6.17935 6.63772C6.20199 6.25548 6.12012 5.87432 5.94269 5.53594L5.93341 5.52031C5.77836 5.26096 5.56676 5.04079 5.31471 4.87656C5.06317 4.71734 4.79091 4.59429 4.50576 4.51094C4.34181 4.4625 4.1562 4.4125 3.93501 4.35469C3.75868 4.30625 3.56689 4.26094 3.27146 4.19844C2.96201 4.13422 2.65794 4.04594 2.36197 3.93438C2.21183 3.87763 2.07792 3.78423 1.97219 3.6625C1.88949 3.56305 1.84647 3.43603 1.85154 3.30625C1.85154 3.28594 1.85154 3.26562 1.85154 3.24531C1.86148 3.13668 1.90291 3.03341 1.97064 2.94844C2.09472 2.80405 2.25501 2.6961 2.43467 2.63594C2.72863 2.53698 3.03752 2.49096 3.34725 2.5H3.36736C3.60187 2.4996 3.8354 2.5306 4.06185 2.59219C4.21659 2.6355 4.36264 2.70583 4.49339 2.8C4.57522 2.85751 4.64555 2.93014 4.70065 3.01406L5.04249 3.53594L6.07417 2.84531L5.73234 2.32344C5.59215 2.10925 5.4132 1.92371 5.2049 1.77656C4.95857 1.60032 4.6838 1.46868 4.39285 1.3875C4.26913 1.3531 4.14366 1.32545 4.01699 1.30469V0H2.77959Z"
						fill="currentColor"
					/>
				</svg>

				<svg
					class="size-3 partial-fill text-lightGray-100 dark:text-white"
					viewBox="0 0 7 10"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						d="M2.77959 0V1.28281C2.52994 1.31456 2.2839 1.37055 2.04489 1.45C1.65279 1.58184 1.30327 1.81831 1.03331 2.13437L1.0163 2.15469C0.769755 2.45972 0.628548 2.83773 0.614144 3.23125C0.587936 3.66321 0.718852 4.08996 0.982271 4.43125L1.00238 4.45781C1.24654 4.74976 1.56074 4.97355 1.91496 5.10781C2.26744 5.23974 2.62941 5.34421 2.99768 5.42031C3.26991 5.47969 3.44469 5.52031 3.60092 5.56406H3.61793C3.8221 5.61406 3.9907 5.65938 4.14073 5.70312C4.319 5.75661 4.48879 5.83553 4.64497 5.9375C4.73343 5.99414 4.80885 6.06926 4.86616 6.15781C4.92198 6.26618 4.94915 6.38728 4.94504 6.50938C4.94504 6.51875 4.94504 6.52813 4.94504 6.5375C4.94975 6.68765 4.90576 6.83525 4.81975 6.95781C4.68969 7.13102 4.51224 7.26193 4.30933 7.33438C3.99665 7.45508 3.66323 7.51139 3.32869 7.5H3.29002C2.92728 7.51159 2.56694 7.43664 2.23823 7.28125C2.07741 7.19611 1.93901 7.07344 1.83453 6.92344L1.47568 6.41406L0.46875 7.14062L0.826049 7.65625C1.04805 7.97102 1.34132 8.22763 1.6814 8.40469L1.69842 8.4125C2.04079 8.57358 2.4062 8.67904 2.78114 8.725V10H4.01854V8.7C4.26861 8.66069 4.51386 8.5947 4.75015 8.50313C5.17357 8.34525 5.54302 8.06751 5.81431 7.70313C6.03042 7.38853 6.1567 7.01995 6.17935 6.63772C6.20199 6.25548 6.12012 5.87432 5.94269 5.53594L5.93341 5.52031C5.77836 5.26096 5.56676 5.04079 5.31471 4.87656C5.06317 4.71734 4.79091 4.59429 4.50576 4.51094C4.34181 4.4625 4.1562 4.4125 3.93501 4.35469C3.75868 4.30625 3.56689 4.26094 3.27146 4.19844C2.96201 4.13422 2.65794 4.04594 2.36197 3.93438C2.21183 3.87763 2.07792 3.78423 1.97219 3.6625C1.88949 3.56305 1.84647 3.43603 1.85154 3.30625C1.85154 3.28594 1.85154 3.26562 1.85154 3.24531C1.86148 3.13668 1.90291 3.03341 1.97064 2.94844C2.09472 2.80405 2.25501 2.6961 2.43467 2.63594C2.72863 2.53698 3.03752 2.49096 3.34725 2.5H3.36736C3.60187 2.4996 3.8354 2.5306 4.06185 2.59219C4.21659 2.6355 4.36264 2.70583 4.49339 2.8C4.57522 2.85751 4.64555 2.93014 4.70065 3.01406L5.04249 3.53594L6.07417 2.84531L5.73234 2.32344C5.59215 2.10925 5.4132 1.92371 5.2049 1.77656C4.95857 1.60032 4.6838 1.46868 4.39285 1.3875C4.26913 1.3531 4.14366 1.32545 4.01699 1.30469V0H2.77959Z"
						fill="currentColor"
					/>
				</svg>
			</div>
		{/if}

		{#each Array(max - fullStars - (hasPartial ? 1 : 0)) as _, i}
			<svg
				class="size-3 text-lightGray-900 dark:text-white/50"
				viewBox="0 0 7 10"
				fill="none"
				xmlns="http://www.w3.org/2000/svg"
			>
				<path
					d="M2.77959 0V1.28281C2.52994 1.31456 2.2839 1.37055 2.04489 1.45C1.65279 1.58184 1.30327 1.81831 1.03331 2.13437L1.0163 2.15469C0.769755 2.45972 0.628548 2.83773 0.614144 3.23125C0.587936 3.66321 0.718852 4.08996 0.982271 4.43125L1.00238 4.45781C1.24654 4.74976 1.56074 4.97355 1.91496 5.10781C2.26744 5.23974 2.62941 5.34421 2.99768 5.42031C3.26991 5.47969 3.44469 5.52031 3.60092 5.56406H3.61793C3.8221 5.61406 3.9907 5.65938 4.14073 5.70312C4.319 5.75661 4.48879 5.83553 4.64497 5.9375C4.73343 5.99414 4.80885 6.06926 4.86616 6.15781C4.92198 6.26618 4.94915 6.38728 4.94504 6.50938C4.94504 6.51875 4.94504 6.52813 4.94504 6.5375C4.94975 6.68765 4.90576 6.83525 4.81975 6.95781C4.68969 7.13102 4.51224 7.26193 4.30933 7.33438C3.99665 7.45508 3.66323 7.51139 3.32869 7.5H3.29002C2.92728 7.51159 2.56694 7.43664 2.23823 7.28125C2.07741 7.19611 1.93901 7.07344 1.83453 6.92344L1.47568 6.41406L0.46875 7.14062L0.826049 7.65625C1.04805 7.97102 1.34132 8.22763 1.6814 8.40469L1.69842 8.4125C2.04079 8.57358 2.4062 8.67904 2.78114 8.725V10H4.01854V8.7C4.26861 8.66069 4.51386 8.5947 4.75015 8.50313C5.17357 8.34525 5.54302 8.06751 5.81431 7.70313C6.03042 7.38853 6.1567 7.01995 6.17935 6.63772C6.20199 6.25548 6.12012 5.87432 5.94269 5.53594L5.93341 5.52031C5.77836 5.26096 5.56676 5.04079 5.31471 4.87656C5.06317 4.71734 4.79091 4.59429 4.50576 4.51094C4.34181 4.4625 4.1562 4.4125 3.93501 4.35469C3.75868 4.30625 3.56689 4.26094 3.27146 4.19844C2.96201 4.13422 2.65794 4.04594 2.36197 3.93438C2.21183 3.87763 2.07792 3.78423 1.97219 3.6625C1.88949 3.56305 1.84647 3.43603 1.85154 3.30625C1.85154 3.28594 1.85154 3.26562 1.85154 3.24531C1.86148 3.13668 1.90291 3.03341 1.97064 2.94844C2.09472 2.80405 2.25501 2.6961 2.43467 2.63594C2.72863 2.53698 3.03752 2.49096 3.34725 2.5H3.36736C3.60187 2.4996 3.8354 2.5306 4.06185 2.59219C4.21659 2.6355 4.36264 2.70583 4.49339 2.8C4.57522 2.85751 4.64555 2.93014 4.70065 3.01406L5.04249 3.53594L6.07417 2.84531L5.73234 2.32344C5.59215 2.10925 5.4132 1.92371 5.2049 1.77656C4.95857 1.60032 4.6838 1.46868 4.39285 1.3875C4.26913 1.3531 4.14366 1.32545 4.01699 1.30469V0H2.77959Z"
					fill="currentColor"
				/>
			</svg>
		{/each}
	</div>
	<p class="text-xs text-lightGray-100 dark:text-white">
		{rating.toFixed(1)}/5
	</p>
</div>

<style>
	.partial-wrapper {
		position: relative;
	}

	.partial-fill {
		position: absolute;
		top: 0;
		left: 0;
		/* color: #ffffff; */
		clip-path: inset(0 calc(100% - var(--fill, 0%)) 0 0);
		pointer-events: none;
	}
</style>
