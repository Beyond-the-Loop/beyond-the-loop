<script lang="ts">
	export let rating: number = 0;
	export let max: number = 5;

	$: fullStars = Math.floor(rating);
	$: hasPartial = rating % 1 !== 0;
	$: partialFill = (rating % 1) * 100;
</script>

<div class="flex items-center gap-2.5">
    <div class="flex gap-1">
        {#each Array(fullStars) as _, i}
        <svg  class="star filled text-lightGray-100 dark:text-white" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M4.89605 7.88673L2.67009 9.053C2.60403 9.08738 2.52972 9.10273 2.45545 9.09732C2.38118 9.09191 2.30987 9.06597 2.24949 9.02239C2.1891 8.9788 2.14203 8.91929 2.11351 8.8505C2.08499 8.78171 2.07615 8.70634 2.08798 8.63282L2.51329 6.16192L0.712641 4.41251C0.658895 4.36056 0.620839 4.29453 0.60282 4.22198C0.5848 4.14944 0.587543 4.07328 0.610733 4.00222C0.633923 3.93115 0.676627 3.86804 0.73397 3.82008C0.791313 3.77212 0.860984 3.74125 0.935032 3.73099L3.42335 3.37025L4.53633 1.12277C4.56962 1.05583 4.62092 0.999507 4.68447 0.960135C4.74802 0.920762 4.82129 0.899902 4.89605 0.899902C4.97081 0.899902 5.04408 0.920762 5.10763 0.960135C5.17118 0.999507 5.22248 1.05583 5.25577 1.12277L6.36875 3.37025L8.85707 3.73099C8.9309 3.74161 9.00029 3.77268 9.05738 3.82069C9.11447 3.86869 9.15699 3.93171 9.18013 4.00262C9.20327 4.07353 9.2061 4.1495 9.18831 4.22194C9.17052 4.29438 9.13282 4.36039 9.07946 4.41251L7.27881 6.16192L7.7031 8.63179C7.71583 8.70545 7.70766 8.78119 7.6795 8.85043C7.65135 8.91967 7.60434 8.97963 7.54383 9.0235C7.48331 9.06737 7.4117 9.09338 7.33714 9.0986C7.26258 9.10382 7.18805 9.08802 7.12201 9.053L4.89605 7.88673Z"
                stroke="currentColor"
                fill="currentColor"
                stroke-width="0.96"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
        </svg>
        {/each}

        {#if hasPartial}
            <div class="star partial-wrapper text-lightGray-100 dark:text-white" style="--fill: {partialFill}%">
                <svg  class="star" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M4.89605 7.88673L2.67009 9.053C2.60403 9.08738 2.52972 9.10273 2.45545 9.09732C2.38118 9.09191 2.30987 9.06597 2.24949 9.02239C2.1891 8.9788 2.14203 8.91929 2.11351 8.8505C2.08499 8.78171 2.07615 8.70634 2.08798 8.63282L2.51329 6.16192L0.712641 4.41251C0.658895 4.36056 0.620839 4.29453 0.60282 4.22198C0.5848 4.14944 0.587543 4.07328 0.610733 4.00222C0.633923 3.93115 0.676627 3.86804 0.73397 3.82008C0.791313 3.77212 0.860984 3.74125 0.935032 3.73099L3.42335 3.37025L4.53633 1.12277C4.56962 1.05583 4.62092 0.999507 4.68447 0.960135C4.74802 0.920762 4.82129 0.899902 4.89605 0.899902C4.97081 0.899902 5.04408 0.920762 5.10763 0.960135C5.17118 0.999507 5.22248 1.05583 5.25577 1.12277L6.36875 3.37025L8.85707 3.73099C8.9309 3.74161 9.00029 3.77268 9.05738 3.82069C9.11447 3.86869 9.15699 3.93171 9.18013 4.00262C9.20327 4.07353 9.2061 4.1495 9.18831 4.22194C9.17052 4.29438 9.13282 4.36039 9.07946 4.41251L7.27881 6.16192L7.7031 8.63179C7.71583 8.70545 7.70766 8.78119 7.6795 8.85043C7.65135 8.91967 7.60434 8.97963 7.54383 9.0235C7.48331 9.06737 7.4117 9.09338 7.33714 9.0986C7.26258 9.10382 7.18805 9.08802 7.12201 9.053L4.89605 7.88673Z"
                        stroke="currentColor"
                        stroke-width="0.96"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    />
                </svg>

                <svg  class="star partial-fill text-lightGray-100 dark:text-white" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M4.89605 7.88673L2.67009 9.053C2.60403 9.08738 2.52972 9.10273 2.45545 9.09732C2.38118 9.09191 2.30987 9.06597 2.24949 9.02239C2.1891 8.9788 2.14203 8.91929 2.11351 8.8505C2.08499 8.78171 2.07615 8.70634 2.08798 8.63282L2.51329 6.16192L0.712641 4.41251C0.658895 4.36056 0.620839 4.29453 0.60282 4.22198C0.5848 4.14944 0.587543 4.07328 0.610733 4.00222C0.633923 3.93115 0.676627 3.86804 0.73397 3.82008C0.791313 3.77212 0.860984 3.74125 0.935032 3.73099L3.42335 3.37025L4.53633 1.12277C4.56962 1.05583 4.62092 0.999507 4.68447 0.960135C4.74802 0.920762 4.82129 0.899902 4.89605 0.899902C4.97081 0.899902 5.04408 0.920762 5.10763 0.960135C5.17118 0.999507 5.22248 1.05583 5.25577 1.12277L6.36875 3.37025L8.85707 3.73099C8.9309 3.74161 9.00029 3.77268 9.05738 3.82069C9.11447 3.86869 9.15699 3.93171 9.18013 4.00262C9.20327 4.07353 9.2061 4.1495 9.18831 4.22194C9.17052 4.29438 9.13282 4.36039 9.07946 4.41251L7.27881 6.16192L7.7031 8.63179C7.71583 8.70545 7.70766 8.78119 7.6795 8.85043C7.65135 8.91967 7.60434 8.97963 7.54383 9.0235C7.48331 9.06737 7.4117 9.09338 7.33714 9.0986C7.26258 9.10382 7.18805 9.08802 7.12201 9.053L4.89605 7.88673Z"
                        stroke="currentColor"
                        fill="currentColor"
                        stroke-width="0.96"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                    />
                </svg>
            </div>
        {/if}

        {#each Array(max - fullStars - (hasPartial ? 1 : 0)) as _, i}
        <svg  class="star text-lightGray-100 dark:text-white" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M4.89605 7.88673L2.67009 9.053C2.60403 9.08738 2.52972 9.10273 2.45545 9.09732C2.38118 9.09191 2.30987 9.06597 2.24949 9.02239C2.1891 8.9788 2.14203 8.91929 2.11351 8.8505C2.08499 8.78171 2.07615 8.70634 2.08798 8.63282L2.51329 6.16192L0.712641 4.41251C0.658895 4.36056 0.620839 4.29453 0.60282 4.22198C0.5848 4.14944 0.587543 4.07328 0.610733 4.00222C0.633923 3.93115 0.676627 3.86804 0.73397 3.82008C0.791313 3.77212 0.860984 3.74125 0.935032 3.73099L3.42335 3.37025L4.53633 1.12277C4.56962 1.05583 4.62092 0.999507 4.68447 0.960135C4.74802 0.920762 4.82129 0.899902 4.89605 0.899902C4.97081 0.899902 5.04408 0.920762 5.10763 0.960135C5.17118 0.999507 5.22248 1.05583 5.25577 1.12277L6.36875 3.37025L8.85707 3.73099C8.9309 3.74161 9.00029 3.77268 9.05738 3.82069C9.11447 3.86869 9.15699 3.93171 9.18013 4.00262C9.20327 4.07353 9.2061 4.1495 9.18831 4.22194C9.17052 4.29438 9.13282 4.36039 9.07946 4.41251L7.27881 6.16192L7.7031 8.63179C7.71583 8.70545 7.70766 8.78119 7.6795 8.85043C7.65135 8.91967 7.60434 8.97963 7.54383 9.0235C7.48331 9.06737 7.4117 9.09338 7.33714 9.0986C7.26258 9.10382 7.18805 9.08802 7.12201 9.053L4.89605 7.88673Z"
                stroke="currentColor"
                stroke-width="0.96"
                stroke-linecap="round"
                stroke-linejoin="round"
            />
        </svg>
        {/each}
    </div>
    <p class="text-xs text-lightGray-100 dark:text-white">
        {rating.toFixed(1)}/5
    </p>
</div>



<style>
	.star {
		width: 1rem;
		height: 1rem;
	}

	.filled {
		/* color: #ffffff;  */
	}

	.partial-wrapper {
		position: relative;
	}

	.partial-fill {
		position: absolute;
		top: 0;
		left: 0;
		/* color: #ffffff; */
		clip-path: inset(0 calc(100% - var(--fill, 0%)) 0 0);
		pointer-events: none;
	}
</style>
